# üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

## –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å AI
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ AI** - —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞
- **–¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –Ω–∞–º–µ—Ä–µ–Ω–∏–π** - –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ–Ω—Ç–æ–≤
- **–ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤** - –æ—Ü–µ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Å–∫–∞–ª–∞—Ü–∏–π –∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º** - –∫–æ–≥–¥–∞ AI –Ω–µ —Å–º–æ–≥ –ø–æ–º–æ—á—å

### –ë–∏–∑–Ω–µ—Å –º–µ—Ç—Ä–∏–∫–∏
- **–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤** - NPS –∏ CSAT scores
- **–ö–æ–Ω–≤–µ—Ä—Å–∏—è –¥–∏–∞–ª–æ–≥–æ–≤** - –ø—Ä–æ—Ü–µ–Ω—Ç –¥–∏–∞–ª–æ–≥–æ–≤, –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö—Å—è –¥–µ–π—Å—Ç–≤–∏–µ–º
- **–í—Ä–µ–º—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤** - –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ —Ä–µ—à–µ–Ω–∏—è
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π** - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- **Uptime —Å–µ—Ä–≤–∏—Å–æ–≤** - –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- **–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å** - RPS (requests per second)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** - CPU, RAM, disk usage
- **–û—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### Structured Logging
```python
import structlog

logger = structlog.get_logger()

# –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logger.info(
    "–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è",
    user_id=user_id,
    platform="telegram",
    intent=detected_intent,
    response_time=response_time_ms,
    ai_model="gpt-4"
)
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **INFO** - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- **WARNING** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- **ERROR** - –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è
- **CRITICAL** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞

### –§–æ—Ä–º–∞—Ç—ã –ª–æ–≥–æ–≤
```json
{
    "timestamp": "2024-01-15T10:30:00Z",
    "level": "INFO",
    "service": "conversation-service",
    "user_id": "user123",
    "session_id": "sess456",
    "event": "message_processed",
    "platform": "telegram",
    "intent": "order_status",
    "confidence": 0.95,
    "response_time_ms": 245,
    "ai_tokens_used": 150,
    "cost_usd": 0.003
}
```

## –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### Prometheus + Grafana
```python
# –ú–µ—Ç—Ä–∏–∫–∏ –≤ –∫–æ–¥–µ
from prometheus_client import Counter, Histogram, Gauge

# –°—á–µ—Ç—á–∏–∫–∏
message_counter = Counter('messages_total', 'Total messages processed', ['platform', 'intent'])
error_counter = Counter('errors_total', 'Total errors', ['error_type', 'service'])

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏
response_time = Histogram('response_time_seconds', 'Response time', ['service', 'endpoint'])

# Gauges –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
active_sessions = Gauge('active_sessions', 'Current active sessions')

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
message_counter.labels(platform='telegram', intent='order_status').inc()
with response_time.labels(service='ai', endpoint='/chat').time():
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
    pass
```

### Health Checks
```python
# app/api/routes/health.py
@router.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "timestamp": datetime.utcnow(),
        "version": "1.0.0",
        "services": {
            "database": await check_database(),
            "redis": await check_redis(),
            "ai_service": await check_ai_service(),
        }
    }

@router.get("/health/db")
async def database_health():
    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
        await database.execute("SELECT 1")
        return {"status": "healthy", "latency_ms": latency}
    except Exception as e:
        return {"status": "unhealthy", "error": str(e)}
```

## –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã
- **API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** > 1 –º–∏–Ω—É—Ç—ã
- **–û—à–∏–±–∫–∏** > 5% –æ—Ç –æ–±—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞** > 10 —Å–µ–∫—É–Ω–¥
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞** > 85%
- **–ü–∞–º—è—Ç—å** > 90%

### –ë–∏–∑–Ω–µ—Å –∞–ª–µ—Ä—Ç—ã
- **–ü–∞–¥–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏** < 4.0/5.0
- **–†–æ—Å—Ç —ç—Å–∫–∞–ª–∞—Ü–∏–π** > 20% –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–∑—ã–≤—ã** —Å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
```yaml
# alertmanager.yml
groups:
- name: easy-flow
  rules:
  - alert: HighErrorRate
    expr: rate(errors_total[5m]) > 0.05
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "High error rate detected"
      description: "Error rate is {{ $value }} errors per second"

  - alert: SlowResponseTime
    expr: histogram_quantile(0.95, response_time_seconds) > 10
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "Slow response time"
      description: "95th percentile response time is {{ $value }}s"
```

## –î–∞—à–±–æ—Ä–¥—ã

### –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
- –¢–µ–∫—É—â–∏–π RPS –∏ —Å—Ç–∞—Ç—É—Å—ã API
- –û—à–∏–±–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏

### –ë–∏–∑–Ω–µ—Å –¥–∞—à–±–æ—Ä–¥
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∏–∞–ª–æ–≥–æ–≤ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º
- –¢–æ–ø –∏–Ω—Ç–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º
- –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –¥–µ–π—Å—Ç–≤–∏—è

### AI Performance –¥–∞—à–±–æ—Ä–¥
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ AI –º–æ–¥–µ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å
- –¢–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–Ω—Ç–µ–Ω—Ç–æ–≤
- –ö–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

## –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
```python
# –ú–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫
class ConversationMetrics(Base):
    __tablename__ = "conversation_metrics"
    
    id = Column(UUID, primary_key=True)
    timestamp = Column(DateTime, default=datetime.utcnow)
    user_id = Column(String)
    platform = Column(String)
    intent = Column(String)
    confidence = Column(Float)
    response_time_ms = Column(Integer)
    tokens_used = Column(Integer)
    cost_usd = Column(Numeric(10, 4))
    satisfaction_score = Column(Integer)  # 1-5
    resolved = Column(Boolean, default=False)
```

### –û—Ç—á–µ—Ç—ã
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ** - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –º–µ—Ç—Ä–∏–∫
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ** - —Ç—Ä–µ–Ω–¥—ã –∏ –∞–Ω–æ–º–∞–ª–∏–∏
- **–ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ** - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
```python
@router.get("/analytics/export")
async def export_analytics(
    start_date: date,
    end_date: date,
    format: str = "json"  # json, csv, xlsx
):
    data = await get_analytics_data(start_date, end_date)
    
    if format == "csv":
        return create_csv_response(data)
    elif format == "xlsx":
        return create_excel_response(data)
    else:
        return data
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ webhook'–æ–≤
- –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –õ–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

### SLA –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ SLA
class SLAMetrics:
    def __init__(self):
        self.uptime_target = 0.999  # 99.9%
        self.response_time_target = 2.0  # 2 —Å–µ–∫—É–Ω–¥—ã
        
    async def check_sla_compliance(self):
        current_uptime = await calculate_uptime()
        avg_response_time = await calculate_avg_response_time()
        
        return {
            "uptime": {
                "current": current_uptime,
                "target": self.uptime_target,
                "compliant": current_uptime >= self.uptime_target
            },
            "response_time": {
                "current": avg_response_time,
                "target": self.response_time_target,
                "compliant": avg_response_time <= self.response_time_target
            }
        }
```

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- Redis –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Application-level –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker
- Load balancing
- Auto-scaling –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫

### –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import cProfile
import pstats

def profile_function(func):
    def wrapper(*args, **kwargs):
        pr = cProfile.Profile()
        pr.enable()
        result = func(*args, **kwargs)
        pr.disable()
        
        stats = pstats.Stats(pr)
        stats.sort_stats('cumulative')
        stats.print_stats(10)  # –¢–æ–ø 10 –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
        
        return result
    return wrapper
```